

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ESP HTTPS OTA &mdash; ESP-IDF Programming Guide v4.1-dev-2071-gf91080637 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script type="text/javascript" src="https://media.readthedocs.com/javascript/readthedocs-doc-embed.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="ESP-pthread" href="esp_pthread.html" />
    <link rel="prev" title="Error Codes and Helper Functions" href="esp_err.html" /> 

<!-- RTD Extra Head -->

<!-- 
Always link to the latest version, as canonical.
http://docs.readthedocs.org/en/latest/canonical.html
-->
<link rel="canonical" href="https://docs.espressif.com/projects/esp-idf/en/latest/api-reference/system/esp_https_ota.html" />

<link rel="stylesheet" href="https://media.readthedocs.com/css/readthedocs-doc-embed.css" type="text/css" />

<script type="text/javascript" src="../../_static/readthedocs-data.js"></script>

<!-- Add page-specific data, which must exist in the page js, not global -->
<script type="text/javascript">
READTHEDOCS_DATA['page'] = "api-reference/system/esp_https_ota"
READTHEDOCS_DATA['source_suffix'] = ".rst"
</script>

<script type="text/javascript" src="https://media.readthedocs.com/javascript/readthedocs-analytics.js"></script>

<!-- end RTD <extrahead> -->
<script async type="text/javascript" src="../../../../../../_/static/javascript/readthedocs-addons.js"></script><meta name="readthedocs-project-slug" content="espressif-esp-idf" /><meta name="readthedocs-version-slug" content="latest" /><meta name="readthedocs-resolver-filename" content="/api-reference/system/esp_https_ota.html" /><meta name="readthedocs-http-status" content="200" /></head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> ESP-IDF Programming Guide
          

          
            
            <img src="../../_static/espressif-logo.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../get-started/index.html">Get Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../bluetooth/index.html">Bluetooth</a></li>
<li class="toctree-l2"><a class="reference internal" href="../network/index.html">Networking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../peripherals/index.html">Peripherals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/index.html">Protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="../provisioning/index.html">Provisioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../storage/index.html">Storage</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">System</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="app_image_format.html">App image format</a></li>
<li class="toctree-l3"><a class="reference internal" href="app_trace.html">Application Level Tracing</a></li>
<li class="toctree-l3"><a class="reference internal" href="efuse.html">eFuse Manager</a></li>
<li class="toctree-l3"><a class="reference internal" href="esp_err.html">Error Codes and Helper Functions</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="esp_https_ota.html#">ESP HTTPS OTA</a><ul>
<li class="toctree-l4"><a class="reference internal" href="esp_https_ota.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="esp_https_ota.html#application-example">Application Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="esp_https_ota.html#signature-verification">Signature Verification</a></li>
<li class="toctree-l4"><a class="reference internal" href="esp_https_ota.html#api-reference">API Reference</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="esp_pthread.html">ESP pthread</a></li>
<li class="toctree-l3"><a class="reference internal" href="esp_event.html">Event Loop Library</a></li>
<li class="toctree-l3"><a class="reference internal" href="freertos.html">FreeRTOS</a></li>
<li class="toctree-l3"><a class="reference internal" href="freertos_additions.html">FreeRTOS Additions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mem_alloc.html">Heap Memory Allocation</a></li>
<li class="toctree-l3"><a class="reference internal" href="heap_debug.html">Heap Memory Debugging</a></li>
<li class="toctree-l3"><a class="reference internal" href="esp_timer.html">High Resolution Timer</a></li>
<li class="toctree-l3"><a class="reference internal" href="himem.html">Himem (large external SPI RAM) API</a></li>
<li class="toctree-l3"><a class="reference internal" href="ipc.html">Inter-Processor Call</a></li>
<li class="toctree-l3"><a class="reference internal" href="esp_expression_with_stack.html">Call function with external stack</a></li>
<li class="toctree-l3"><a class="reference internal" href="intr_alloc.html">Interrupt Allocation</a></li>
<li class="toctree-l3"><a class="reference internal" href="log.html">Logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="system.html">Miscellaneous System APIs</a></li>
<li class="toctree-l3"><a class="reference internal" href="ota.html">Over The Air Updates (OTA)</a></li>
<li class="toctree-l3"><a class="reference internal" href="perfmon.html">Performance Monitor</a></li>
<li class="toctree-l3"><a class="reference internal" href="power_management.html">Power Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="sleep_modes.html">Sleep Modes</a></li>
<li class="toctree-l3"><a class="reference internal" href="wdts.html">Watchdogs</a></li>
<li class="toctree-l3"><a class="reference internal" href="system_time.html">System Time</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../kconfig.html">Configuration Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../error-codes.html">Error Codes Reference</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../hw-reference/index.html">H/W Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../esp32s2.html">ESP32-S2 Preview Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api-guides/index.html">API Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../libraries-and-frameworks/index.html">Libraries and Frameworks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contribute/index.html">Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../versions.html">Versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources.html">Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COPYRIGHT.html">Copyrights</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../languages.html">语言/Languages</a></li>
<li class="toctree-l1"><a class="reference external" href="https://readthedocs.com/projects/espressif-esp-idf/downloads/">Guide Downloads</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">ESP-IDF Programming Guide</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">API Reference</a> &raquo;</li>
        
          <li><a href="index.html">System API</a> &raquo;</li>
        
      <li>ESP HTTPS OTA</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/espressif/esp-idf/blob/master/docs/en/api-reference/system/esp_https_ota.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="esp-https-ota">
<h1>ESP HTTPS OTA<a class="headerlink" href="esp_https_ota.html#esp-https-ota" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="esp_https_ota.html#overview" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">esp_https_ota</span></code> provides simplified APIs to perform firmware upgrades over HTTPS.
It’s an abstraction layer over existing OTA APIs.</p>
</div>
<div class="section" id="application-example">
<h2>Application Example<a class="headerlink" href="esp_https_ota.html#application-example" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">esp_err_t</span> <span class="nf">do_firmware_upgrade</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">esp_http_client_config_t</span> <span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">.</span><span class="n">url</span> <span class="o">=</span> <span class="n">CONFIG_FIRMWARE_UPGRADE_URL</span><span class="p">,</span>
        <span class="p">.</span><span class="n">cert_pem</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">server_cert_pem_start</span><span class="p">,</span>
    <span class="p">};</span>
    <span class="n">esp_err_t</span> <span class="n">ret</span> <span class="o">=</span> <span class="n">esp_https_ota</span><span class="p">(</span><span class="o">&amp;</span><span class="n">config</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">==</span> <span class="n">ESP_OK</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">esp_restart</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">ESP_FAIL</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">ESP_OK</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="signature-verification">
<h2>Signature Verification<a class="headerlink" href="esp_https_ota.html#signature-verification" title="Permalink to this headline">¶</a></h2>
<p>For additional security, signature of OTA firmware images can be verified. For that, refer <a class="reference internal" href="ota.html#secure-ota-updates"><span class="std std-ref">Secure OTA Updates Without Secure boot</span></a></p>
</div>
<div class="section" id="api-reference">
<h2>API Reference<a class="headerlink" href="esp_https_ota.html#api-reference" title="Permalink to this headline">¶</a></h2>
<div class="section" id="header-file">
<h3>Header File<a class="headerlink" href="esp_https_ota.html#header-file" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference external" href="https://github.com/espressif/esp-idf/blob/f91080637/components/esp_https_ota/include/esp_https_ota.h">esp_https_ota/include/esp_https_ota.h</a></li>
</ul>
</div>
<div class="section" id="functions">
<h3>Functions<a class="headerlink" href="esp_https_ota.html#functions" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="_CPPv413esp_https_otaPK24esp_http_client_config_t">
<span id="_CPPv313esp_https_otaPK24esp_http_client_config_t"></span><span id="_CPPv213esp_https_otaPK24esp_http_client_config_t"></span><span id="esp_https_ota__esp_http_client_config_tCP"></span><span class="target" id="esp__https__ota_8h_1a8ecac05768ae4695c86880671f84cd3b"></span><a class="reference internal" href="esp_err.html#_CPPv49esp_err_t" title="esp_err_t">esp_err_t</a> <code class="descname">esp_https_ota</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="../protocols/esp_http_client.html#_CPPv424esp_http_client_config_t" title="esp_http_client_config_t">esp_http_client_config_t</a> *<em>config</em><span class="sig-paren">)</span><a class="headerlink" href="esp_https_ota.html#_CPPv413esp_https_otaPK24esp_http_client_config_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>HTTPS OTA Firmware upgrade. </p>
<p>This function allocates HTTPS OTA Firmware upgrade context, establishes HTTPS connection, reads image data from HTTP stream and writes it to OTA partition and finishes HTTPS OTA Firmware upgrade operation. This API supports URL redirection, but if CA cert of URLs differ then it should be appended to <code class="docutils literal notranslate"><span class="pre">cert_pem</span></code> member of <code class="docutils literal notranslate"><span class="pre">config</span></code>.</p>
<p><dl class="docutils">
<dt><strong>Note</strong></dt>
<dd>This API handles the entire OTA operation, so if this API is being used then no other APIs from <code class="docutils literal notranslate"><span class="pre">esp_https_ota</span></code> component should be called. If more information and control is needed during the HTTPS OTA process, then one can use <code class="docutils literal notranslate"><span class="pre">esp_https_ota_begin</span></code> and subsequent APIs. If this API returns successfully, esp_restart() must be called to boot from the new firmware image.</dd>
<dt><strong>Return</strong></dt>
<dd><ul class="simple">
<li>ESP_OK: OTA data updated, next reboot will use specified partition.</li>
<li>ESP_FAIL: For generic failure.</li>
<li>ESP_ERR_INVALID_ARG: Invalid argument</li>
<li>ESP_ERR_OTA_VALIDATE_FAILED: Invalid app image</li>
<li>ESP_ERR_NO_MEM: Cannot allocate memory for OTA operation.</li>
<li>ESP_ERR_FLASH_OP_TIMEOUT or ESP_ERR_FLASH_OP_FAIL: Flash write failed.</li>
<li>For other return codes, refer OTA documentation in esp-idf’s app_update component. </li>
</ul>
</dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal notranslate"><span class="pre">config</span></code>: pointer to <a class="reference internal" href="../protocols/esp_http_client.html#structesp__http__client__config__t"><span class="std std-ref">esp_http_client_config_t</span></a> structure.</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv419esp_https_ota_beginP22esp_https_ota_config_tP22esp_https_ota_handle_t">
<span id="_CPPv319esp_https_ota_beginP22esp_https_ota_config_tP22esp_https_ota_handle_t"></span><span id="_CPPv219esp_https_ota_beginP22esp_https_ota_config_tP22esp_https_ota_handle_t"></span><span id="esp_https_ota_begin__esp_https_ota_config_tP.esp_https_ota_handle_tP"></span><span class="target" id="esp__https__ota_8h_1ac48c261d035091e7dae320650b45437d"></span><a class="reference internal" href="esp_err.html#_CPPv49esp_err_t" title="esp_err_t">esp_err_t</a> <code class="descname">esp_https_ota_begin</code><span class="sig-paren">(</span><a class="reference internal" href="esp_https_ota.html#_CPPv422esp_https_ota_config_t" title="esp_https_ota_config_t">esp_https_ota_config_t</a> *<em>ota_config</em>, <a class="reference internal" href="esp_https_ota.html#_CPPv422esp_https_ota_handle_t" title="esp_https_ota_handle_t">esp_https_ota_handle_t</a> *<em>handle</em><span class="sig-paren">)</span><a class="headerlink" href="esp_https_ota.html#_CPPv419esp_https_ota_beginP22esp_https_ota_config_tP22esp_https_ota_handle_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Start HTTPS OTA Firmware upgrade. </p>
<p>This function initializes ESP HTTPS OTA context and establishes HTTPS connection. This function must be invoked first. If this function returns successfully, then <code class="docutils literal notranslate"><span class="pre">esp_https_ota_perform</span></code> should be called to continue with the OTA process and there should be a call to <code class="docutils literal notranslate"><span class="pre">esp_https_ota_finish</span></code> on completion of OTA operation or on failure in subsequent operations. This API supports URL redirection, but if CA cert of URLs differ then it should be appended to <code class="docutils literal notranslate"><span class="pre">cert_pem</span></code> member of <code class="docutils literal notranslate"><span class="pre">http_config</span></code>, which is a part of <code class="docutils literal notranslate"><span class="pre">ota_config</span></code>. In case of error, this API explicitly sets <code class="docutils literal notranslate"><span class="pre">handle</span></code> to NULL.</p>
<p><dl class="docutils">
<dt><strong>Note</strong></dt>
<dd>This API is blocking, so setting <code class="docutils literal notranslate"><span class="pre">is_async</span></code> member of <code class="docutils literal notranslate"><span class="pre">http_config</span></code> structure will result in an error.</dd>
<dt><strong>Return</strong></dt>
<dd><ul class="simple">
<li>ESP_OK: HTTPS OTA Firmware upgrade context initialised and HTTPS connection established</li>
<li>ESP_FAIL: For generic failure.</li>
<li>ESP_ERR_INVALID_ARG: Invalid argument (missing/incorrect config, certificate, etc.)</li>
<li>For other return codes, refer documentation in app_update component and esp_http_client component in esp-idf. </li>
</ul>
</dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal notranslate"><span class="pre">ota_config</span></code>: pointer to <a class="reference internal" href="esp_https_ota.html#structesp__https__ota__config__t"><span class="std std-ref">esp_https_ota_config_t</span></a> structure </li>
<li><code class="docutils literal notranslate"><span class="pre">handle</span></code>: pointer to an allocated data of type <code class="docutils literal notranslate"><span class="pre">esp_https_ota_handle_t</span></code> which will be initialised in this function</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv421esp_https_ota_perform22esp_https_ota_handle_t">
<span id="_CPPv321esp_https_ota_perform22esp_https_ota_handle_t"></span><span id="_CPPv221esp_https_ota_perform22esp_https_ota_handle_t"></span><span id="esp_https_ota_perform__esp_https_ota_handle_t"></span><span class="target" id="esp__https__ota_8h_1a4918c83bae2b48b2a5b4c76d935032d9"></span><a class="reference internal" href="esp_err.html#_CPPv49esp_err_t" title="esp_err_t">esp_err_t</a> <code class="descname">esp_https_ota_perform</code><span class="sig-paren">(</span><a class="reference internal" href="esp_https_ota.html#_CPPv422esp_https_ota_handle_t" title="esp_https_ota_handle_t">esp_https_ota_handle_t</a> <em>https_ota_handle</em><span class="sig-paren">)</span><a class="headerlink" href="esp_https_ota.html#_CPPv421esp_https_ota_perform22esp_https_ota_handle_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Read image data from HTTP stream and write it to OTA partition. </p>
<p>This function reads image data from HTTP stream and writes it to OTA partition. This function must be called only if esp_https_ota_begin() returns successfully. This function must be called in a loop since it returns after every HTTP read operation thus giving you the flexibility to stop OTA operation midway.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd><ul class="simple">
<li>ESP_ERR_HTTPS_OTA_IN_PROGRESS: OTA update is in progress, call this API again to continue.</li>
<li>ESP_OK: OTA update was successful</li>
<li>ESP_FAIL: OTA update failed</li>
<li>ESP_ERR_INVALID_ARG: Invalid argument</li>
<li>ESP_ERR_OTA_VALIDATE_FAILED: Invalid app image</li>
<li>ESP_ERR_NO_MEM: Cannot allocate memory for OTA operation.</li>
<li>ESP_ERR_FLASH_OP_TIMEOUT or ESP_ERR_FLASH_OP_FAIL: Flash write failed.</li>
<li>For other return codes, refer OTA documentation in esp-idf’s app_update component. </li>
</ul>
</dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal notranslate"><span class="pre">https_ota_handle</span></code>: pointer to esp_https_ota_handle_t structure</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv439esp_https_ota_is_complete_data_received22esp_https_ota_handle_t">
<span id="_CPPv339esp_https_ota_is_complete_data_received22esp_https_ota_handle_t"></span><span id="_CPPv239esp_https_ota_is_complete_data_received22esp_https_ota_handle_t"></span><span id="esp_https_ota_is_complete_data_received__esp_https_ota_handle_t"></span><span class="target" id="esp__https__ota_8h_1ac61902c89799531bb9bcb015f7985a4a"></span>bool <code class="descname">esp_https_ota_is_complete_data_received</code><span class="sig-paren">(</span><a class="reference internal" href="esp_https_ota.html#_CPPv422esp_https_ota_handle_t" title="esp_https_ota_handle_t">esp_https_ota_handle_t</a> <em>https_ota_handle</em><span class="sig-paren">)</span><a class="headerlink" href="esp_https_ota.html#_CPPv439esp_https_ota_is_complete_data_received22esp_https_ota_handle_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Checks if complete data was received or not. </p>
<p><dl class="docutils">
<dt><strong>Note</strong></dt>
<dd>This API can be called just before esp_https_ota_finish() to validate if the complete image was indeed received.</dd>
<dt><strong>Return</strong></dt>
<dd><ul class="simple">
<li>false</li>
<li>true </li>
</ul>
</dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal notranslate"><span class="pre">https_ota_handle</span></code>: pointer to esp_https_ota_handle_t structure</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv420esp_https_ota_finish22esp_https_ota_handle_t">
<span id="_CPPv320esp_https_ota_finish22esp_https_ota_handle_t"></span><span id="_CPPv220esp_https_ota_finish22esp_https_ota_handle_t"></span><span id="esp_https_ota_finish__esp_https_ota_handle_t"></span><span class="target" id="esp__https__ota_8h_1a9b7340a4701dc24262f4ecc027c5f210"></span><a class="reference internal" href="esp_err.html#_CPPv49esp_err_t" title="esp_err_t">esp_err_t</a> <code class="descname">esp_https_ota_finish</code><span class="sig-paren">(</span><a class="reference internal" href="esp_https_ota.html#_CPPv422esp_https_ota_handle_t" title="esp_https_ota_handle_t">esp_https_ota_handle_t</a> <em>https_ota_handle</em><span class="sig-paren">)</span><a class="headerlink" href="esp_https_ota.html#_CPPv420esp_https_ota_finish22esp_https_ota_handle_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Clean-up HTTPS OTA Firmware upgrade and close HTTPS connection. </p>
<p>This function closes the HTTP connection and frees the ESP HTTPS OTA context. This function switches the boot partition to the OTA partition containing the new firmware image.</p>
<p><dl class="docutils">
<dt><strong>Note</strong></dt>
<dd>If this API returns successfully, esp_restart() must be called to boot from the new firmware image</dd>
<dt><strong>Return</strong></dt>
<dd><ul class="simple">
<li>ESP_OK: Clean-up successful</li>
<li>ESP_ERR_INVALID_STATE</li>
<li>ESP_ERR_INVALID_ARG: Invalid argument</li>
<li>ESP_ERR_OTA_VALIDATE_FAILED: Invalid app image </li>
</ul>
</dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal notranslate"><span class="pre">https_ota_handle</span></code>: pointer to esp_https_ota_handle_t structure</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv426esp_https_ota_get_img_desc22esp_https_ota_handle_tP14esp_app_desc_t">
<span id="_CPPv326esp_https_ota_get_img_desc22esp_https_ota_handle_tP14esp_app_desc_t"></span><span id="_CPPv226esp_https_ota_get_img_desc22esp_https_ota_handle_tP14esp_app_desc_t"></span><span id="esp_https_ota_get_img_desc__esp_https_ota_handle_t.esp_app_desc_tP"></span><span class="target" id="esp__https__ota_8h_1a73384ac51bdbc13caa32d82e7e0734f8"></span><a class="reference internal" href="esp_err.html#_CPPv49esp_err_t" title="esp_err_t">esp_err_t</a> <code class="descname">esp_https_ota_get_img_desc</code><span class="sig-paren">(</span><a class="reference internal" href="esp_https_ota.html#_CPPv422esp_https_ota_handle_t" title="esp_https_ota_handle_t">esp_https_ota_handle_t</a> <em>https_ota_handle</em>, <a class="reference internal" href="app_image_format.html#_CPPv414esp_app_desc_t" title="esp_app_desc_t">esp_app_desc_t</a> *<em>new_app_info</em><span class="sig-paren">)</span><a class="headerlink" href="esp_https_ota.html#_CPPv426esp_https_ota_get_img_desc22esp_https_ota_handle_tP14esp_app_desc_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Reads app description from image header. The app description provides information like the “Firmware version” of the image. </p>
<p><dl class="docutils">
<dt><strong>Note</strong></dt>
<dd>This API can be called only after esp_https_ota_begin() and before esp_https_ota_perform(). Calling this API is not mandatory.</dd>
<dt><strong>Return</strong></dt>
<dd><ul class="simple">
<li>ESP_ERR_INVALID_ARG: Invalid arguments</li>
<li>ESP_FAIL: Failed to read image descriptor</li>
<li>ESP_OK: Successfully read image descriptor </li>
</ul>
</dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal notranslate"><span class="pre">https_ota_handle</span></code>: pointer to esp_https_ota_handle_t structure </li>
<li><code class="docutils literal notranslate"><span class="pre">new_app_info</span></code>: pointer to an allocated <a class="reference internal" href="app_image_format.html#structesp__app__desc__t"><span class="std std-ref">esp_app_desc_t</span></a> structure</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv432esp_https_ota_get_image_len_read22esp_https_ota_handle_t">
<span id="_CPPv332esp_https_ota_get_image_len_read22esp_https_ota_handle_t"></span><span id="_CPPv232esp_https_ota_get_image_len_read22esp_https_ota_handle_t"></span><span id="esp_https_ota_get_image_len_read__esp_https_ota_handle_t"></span><span class="target" id="esp__https__ota_8h_1af099c5e6a7d3017defeeeb8508ffa8aa"></span>int <code class="descname">esp_https_ota_get_image_len_read</code><span class="sig-paren">(</span><a class="reference internal" href="esp_https_ota.html#_CPPv422esp_https_ota_handle_t" title="esp_https_ota_handle_t">esp_https_ota_handle_t</a> <em>https_ota_handle</em><span class="sig-paren">)</span><a class="headerlink" href="esp_https_ota.html#_CPPv432esp_https_ota_get_image_len_read22esp_https_ota_handle_t" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</div>
<div class="section" id="structures">
<h3>Structures<a class="headerlink" href="esp_https_ota.html#structures" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="_CPPv422esp_https_ota_config_t">
<span id="_CPPv322esp_https_ota_config_t"></span><span id="_CPPv222esp_https_ota_config_t"></span><span id="esp_https_ota_config_t"></span><span class="target" id="structesp__https__ota__config__t"></span><em class="property">struct </em><code class="descname">esp_https_ota_config_t</code><a class="headerlink" href="esp_https_ota.html#_CPPv422esp_https_ota_config_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>ESP HTTPS OTA configuration. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Members</p>
<dl class="member">
<dt id="_CPPv4N22esp_https_ota_config_t11http_configE">
<span id="_CPPv3N22esp_https_ota_config_t11http_configE"></span><span id="_CPPv2N22esp_https_ota_config_t11http_configE"></span><span id="esp_https_ota_config_t::http_config__esp_http_client_config_tCP"></span><span class="target" id="structesp__https__ota__config__t_1a90401d24e37b4a691c4eba05577f7a99"></span><em class="property">const</em> <a class="reference internal" href="../protocols/esp_http_client.html#_CPPv424esp_http_client_config_t" title="esp_http_client_config_t">esp_http_client_config_t</a> *<code class="descname">http_config</code><a class="headerlink" href="esp_https_ota.html#_CPPv4N22esp_https_ota_config_t11http_configE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>ESP HTTP client configuration </p>
</dd></dl>

</div>
</dd></dl>

</div>
<div class="section" id="macros">
<h3>Macros<a class="headerlink" href="esp_https_ota.html#macros" title="Permalink to this headline">¶</a></h3>
<dl class="macro">
<dt id="c.ESP_ERR_HTTPS_OTA_BASE">
<span class="target" id="esp__https__ota_8h_1a01fd923457f18428c256ed1c9d3b890d"></span><code class="descname">ESP_ERR_HTTPS_OTA_BASE</code><a class="headerlink" href="esp_https_ota.html#c.ESP_ERR_HTTPS_OTA_BASE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="c.ESP_ERR_HTTPS_OTA_IN_PROGRESS">
<span class="target" id="esp__https__ota_8h_1affb6f146b88b0fc844ad3e00d83a88ec"></span><code class="descname">ESP_ERR_HTTPS_OTA_IN_PROGRESS</code><a class="headerlink" href="esp_https_ota.html#c.ESP_ERR_HTTPS_OTA_IN_PROGRESS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="type-definitions">
<h3>Type Definitions<a class="headerlink" href="esp_https_ota.html#type-definitions" title="Permalink to this headline">¶</a></h3>
<dl class="type">
<dt id="_CPPv422esp_https_ota_handle_t">
<span id="_CPPv322esp_https_ota_handle_t"></span><span id="_CPPv222esp_https_ota_handle_t"></span><span id="esp_https_ota_handle_t"></span><span class="target" id="esp__https__ota_8h_1a0b4099cc4ff2c5befa0db723ad01237c"></span><em class="property">typedef </em>void *<code class="descname">esp_https_ota_handle_t</code><a class="headerlink" href="esp_https_ota.html#_CPPv422esp_https_ota_handle_t" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="esp_pthread.html" class="btn btn-neutral float-right" title="ESP-pthread" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="esp_err.html" class="btn btn-neutral float-left" title="Error Codes and Helper Functions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016 - 2019, Espressif Systems (Shanghai) CO., LTD
      
        <span class="commit">
          Revision <code>f9108063</code>.
        </span>
      

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  



  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
   

</body>
</html>