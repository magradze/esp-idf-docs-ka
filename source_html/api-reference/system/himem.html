

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>The himem allocation API &mdash; ESP-IDF Programming Guide v4.1-dev-2071-gf91080637 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script type="text/javascript" src="https://media.readthedocs.com/javascript/readthedocs-doc-embed.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Inter-Processor Call" href="ipc.html" />
    <link rel="prev" title="High Resolution Timer" href="esp_timer.html" /> 

<!-- RTD Extra Head -->

<!-- 
Always link to the latest version, as canonical.
http://docs.readthedocs.org/en/latest/canonical.html
-->
<link rel="canonical" href="https://docs.espressif.com/projects/esp-idf/en/latest/api-reference/system/himem.html" />

<link rel="stylesheet" href="https://media.readthedocs.com/css/readthedocs-doc-embed.css" type="text/css" />

<script type="text/javascript" src="../../_static/readthedocs-data.js"></script>

<!-- Add page-specific data, which must exist in the page js, not global -->
<script type="text/javascript">
READTHEDOCS_DATA['page'] = "api-reference/system/himem"
READTHEDOCS_DATA['source_suffix'] = ".rst"
</script>

<script type="text/javascript" src="https://media.readthedocs.com/javascript/readthedocs-analytics.js"></script>

<!-- end RTD <extrahead> -->
<script async type="text/javascript" src="../../../../../../_/static/javascript/readthedocs-addons.js"></script><meta name="readthedocs-project-slug" content="espressif-esp-idf" /><meta name="readthedocs-version-slug" content="latest" /><meta name="readthedocs-resolver-filename" content="/api-reference/system/himem.html" /><meta name="readthedocs-http-status" content="200" /></head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> ESP-IDF Programming Guide
          

          
            
            <img src="../../_static/espressif-logo.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../get-started/index.html">Get Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../bluetooth/index.html">Bluetooth</a></li>
<li class="toctree-l2"><a class="reference internal" href="../network/index.html">Networking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../peripherals/index.html">Peripherals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/index.html">Protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="../provisioning/index.html">Provisioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../storage/index.html">Storage</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">System</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="app_image_format.html">App image format</a></li>
<li class="toctree-l3"><a class="reference internal" href="app_trace.html">Application Level Tracing</a></li>
<li class="toctree-l3"><a class="reference internal" href="efuse.html">eFuse Manager</a></li>
<li class="toctree-l3"><a class="reference internal" href="esp_err.html">Error Codes and Helper Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="esp_https_ota.html">ESP HTTPS OTA</a></li>
<li class="toctree-l3"><a class="reference internal" href="esp_pthread.html">ESP pthread</a></li>
<li class="toctree-l3"><a class="reference internal" href="esp_event.html">Event Loop Library</a></li>
<li class="toctree-l3"><a class="reference internal" href="freertos.html">FreeRTOS</a></li>
<li class="toctree-l3"><a class="reference internal" href="freertos_additions.html">FreeRTOS Additions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mem_alloc.html">Heap Memory Allocation</a></li>
<li class="toctree-l3"><a class="reference internal" href="heap_debug.html">Heap Memory Debugging</a></li>
<li class="toctree-l3"><a class="reference internal" href="esp_timer.html">High Resolution Timer</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="himem.html#">Himem (large external SPI RAM) API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="himem.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="himem.html#example">Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="himem.html#api-reference">API Reference</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ipc.html">Inter-Processor Call</a></li>
<li class="toctree-l3"><a class="reference internal" href="esp_expression_with_stack.html">Call function with external stack</a></li>
<li class="toctree-l3"><a class="reference internal" href="intr_alloc.html">Interrupt Allocation</a></li>
<li class="toctree-l3"><a class="reference internal" href="log.html">Logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="system.html">Miscellaneous System APIs</a></li>
<li class="toctree-l3"><a class="reference internal" href="ota.html">Over The Air Updates (OTA)</a></li>
<li class="toctree-l3"><a class="reference internal" href="perfmon.html">Performance Monitor</a></li>
<li class="toctree-l3"><a class="reference internal" href="power_management.html">Power Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="sleep_modes.html">Sleep Modes</a></li>
<li class="toctree-l3"><a class="reference internal" href="wdts.html">Watchdogs</a></li>
<li class="toctree-l3"><a class="reference internal" href="system_time.html">System Time</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../kconfig.html">Configuration Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../error-codes.html">Error Codes Reference</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../hw-reference/index.html">H/W Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../esp32s2.html">ESP32-S2 Preview Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api-guides/index.html">API Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../libraries-and-frameworks/index.html">Libraries and Frameworks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contribute/index.html">Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../versions.html">Versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources.html">Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COPYRIGHT.html">Copyrights</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../languages.html">语言/Languages</a></li>
<li class="toctree-l1"><a class="reference external" href="https://readthedocs.com/projects/espressif-esp-idf/downloads/">Guide Downloads</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">ESP-IDF Programming Guide</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">API Reference</a> &raquo;</li>
        
          <li><a href="index.html">System API</a> &raquo;</li>
        
      <li>The himem allocation API</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/espressif/esp-idf/blob/master/docs/en/api-reference/system/himem.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="the-himem-allocation-api">
<h1>The himem allocation API<a class="headerlink" href="himem.html#the-himem-allocation-api" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="himem.html#overview" title="Permalink to this headline">¶</a></h2>
<p>The ESP32 can access external SPI RAM transparently, so you can use it as normal memory in your program code. However, because the address
space for external memory is limited in size, only the first 4MiB can be used as such. Access to the remaining memory is still possible,
however this needs to go through a bankswitching scheme controlled by the himem API.</p>
<p>Specifically, what is implemented by the himem API is a bankswitching scheme. Hardware-wise, the 4MiB region for external SPI RAM is
mapped into the CPU address space by a MMU, which maps a configurable 32K bank/page of external SPI RAM into each of the 32K pages in the
4MiB region accessed by the CPU. For external memories that are &lt;=4MiB, this MMU is configured to unity mapping, effectively mapping each
CPU address 1-to-1 to the external SPI RAM address.</p>
<p>In order to use the himem API, you have to enable it in the menuconfig using <span class="target" id="index-0"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CONFIG_SPIRAM_BANKSWITCH_ENABLE</span></code>, as well as set the amount
of banks reserved for this in <span class="target" id="index-1"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CONFIG_SPIRAM_BANKSWITCH_RESERVE</span></code>. This decreases
the amount of external memory allocated by functions like <code class="docutils literal notranslate"><span class="pre">malloc()</span></code>, but it allows you to use the himem api to map any of the remaining memory
into the reserved banks.</p>
<p>The himem API is more-or-less an abstraction of the bankswitching scheme: it allows you to claim one or more banks of address space
(called ‘regions’ in the API) as well as one or more of banks of memory to map into the ranges.</p>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="himem.html#example" title="Permalink to this headline">¶</a></h2>
<p>An example doing a simple memory test of the high memory range is available in esp-idf: <a class="reference external" href="https://github.com/espressif/esp-idf/tree/f91080637/examples/system/himem">system/himem</a></p>
</div>
<div class="section" id="api-reference">
<h2>API Reference<a class="headerlink" href="himem.html#api-reference" title="Permalink to this headline">¶</a></h2>
<div class="section" id="header-file">
<h3>Header File<a class="headerlink" href="himem.html#header-file" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference external" href="https://github.com/espressif/esp-idf/blob/f91080637/components/esp32/include/esp32/himem.h">esp32/include/esp32/himem.h</a></li>
</ul>
</div>
<div class="section" id="functions">
<h3>Functions<a class="headerlink" href="himem.html#functions" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="_CPPv415esp_himem_alloc6size_tP18esp_himem_handle_t">
<span id="_CPPv315esp_himem_alloc6size_tP18esp_himem_handle_t"></span><span id="_CPPv215esp_himem_alloc6size_tP18esp_himem_handle_t"></span><span id="esp_himem_alloc__s.esp_himem_handle_tP"></span><span class="target" id="himem_8h_1ac0c62ea4a941985698ea0aad59876432"></span><a class="reference internal" href="esp_err.html#_CPPv49esp_err_t" title="esp_err_t">esp_err_t</a> <code class="descname">esp_himem_alloc</code><span class="sig-paren">(</span>size_t <em>size</em>, <a class="reference internal" href="himem.html#_CPPv418esp_himem_handle_t" title="esp_himem_handle_t">esp_himem_handle_t</a> *<em>handle_out</em><span class="sig-paren">)</span><a class="headerlink" href="himem.html#_CPPv415esp_himem_alloc6size_tP18esp_himem_handle_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Allocate a block in high memory. </p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>- ESP_OK if succesful<ul class="simple">
<li>ESP_ERR_NO_MEM if out of memory</li>
<li>ESP_ERR_INVALID_SIZE if size is not a multiple of 32K </li>
</ul>
</dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal notranslate"><span class="pre">size</span></code>: Size of the to-be-allocated block, in bytes. Note that this needs to be a multiple of the external RAM mmu block size (32K). </li>
<li><code class="docutils literal notranslate"><span class="pre">handle_out</span></code>: Handle to be returned </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv425esp_himem_alloc_map_range6size_tP23esp_himem_rangehandle_t">
<span id="_CPPv325esp_himem_alloc_map_range6size_tP23esp_himem_rangehandle_t"></span><span id="_CPPv225esp_himem_alloc_map_range6size_tP23esp_himem_rangehandle_t"></span><span id="esp_himem_alloc_map_range__s.esp_himem_rangehandle_tP"></span><span class="target" id="himem_8h_1afa82d2db405af251b21bc89e99439625"></span><a class="reference internal" href="esp_err.html#_CPPv49esp_err_t" title="esp_err_t">esp_err_t</a> <code class="descname">esp_himem_alloc_map_range</code><span class="sig-paren">(</span>size_t <em>size</em>, <a class="reference internal" href="himem.html#_CPPv423esp_himem_rangehandle_t" title="esp_himem_rangehandle_t">esp_himem_rangehandle_t</a> *<em>handle_out</em><span class="sig-paren">)</span><a class="headerlink" href="himem.html#_CPPv425esp_himem_alloc_map_range6size_tP23esp_himem_rangehandle_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Allocate a memory region to map blocks into. </p>
<p>This allocates a contiguous CPU memory region that can be used to map blocks of physical memory into.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>- ESP_OK if succesful<ul class="simple">
<li>ESP_ERR_NO_MEM if out of memory or address space</li>
<li>ESP_ERR_INVALID_SIZE if size is not a multiple of 32K </li>
</ul>
</dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal notranslate"><span class="pre">size</span></code>: Size of the range to be allocated. Note this needs to be a multiple of the external RAM mmu block size (32K). </li>
<li><code class="docutils literal notranslate"><span class="pre">handle_out</span></code>: Handle to be returned </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv413esp_himem_map18esp_himem_handle_t23esp_himem_rangehandle_t6size_t6size_t6size_tiPPv">
<span id="_CPPv313esp_himem_map18esp_himem_handle_t23esp_himem_rangehandle_t6size_t6size_t6size_tiPPv"></span><span id="_CPPv213esp_himem_map18esp_himem_handle_t23esp_himem_rangehandle_t6size_t6size_t6size_tiPPv"></span><span id="esp_himem_map__esp_himem_handle_t.esp_himem_rangehandle_t.s.s.s.i.voidPP"></span><span class="target" id="himem_8h_1a5592756d9a036ab09e26d1ea0be25192"></span><a class="reference internal" href="esp_err.html#_CPPv49esp_err_t" title="esp_err_t">esp_err_t</a> <code class="descname">esp_himem_map</code><span class="sig-paren">(</span><a class="reference internal" href="himem.html#_CPPv418esp_himem_handle_t" title="esp_himem_handle_t">esp_himem_handle_t</a> <em>handle</em>, <a class="reference internal" href="himem.html#_CPPv423esp_himem_rangehandle_t" title="esp_himem_rangehandle_t">esp_himem_rangehandle_t</a> <em>range</em>, size_t <em>ram_offset</em>, size_t <em>range_offset</em>, size_t <em>len</em>, int <em>flags</em>, void **<em>out_ptr</em><span class="sig-paren">)</span><a class="headerlink" href="himem.html#_CPPv413esp_himem_map18esp_himem_handle_t23esp_himem_rangehandle_t6size_t6size_t6size_tiPPv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Map a block of high memory into the CPUs address space. </p>
<p>This effectively makes the block available for read/write operations.</p>
<p><dl class="docutils">
<dt><strong>Note</strong></dt>
<dd>The region to be mapped needs to have offsets and sizes that are aligned to the SPI RAM MMU block size (32K)</dd>
<dt><strong>Return</strong></dt>
<dd>- ESP_OK if the memory could be mapped<ul class="simple">
<li>ESP_ERR_INVALID_ARG if offset, range or len aren’t MMU-block-aligned (32K)</li>
<li>ESP_ERR_INVALID_SIZE if the offsets/lengths don’t fit in the allocated memory or range</li>
<li>ESP_ERR_INVALID_STATE if a block in the selected ram offset/length is already mapped, or if a block in the selected range offset/length already has a mapping. </li>
</ul>
</dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal notranslate"><span class="pre">handle</span></code>: Handle to the block of memory, as given by esp_himem_alloc </li>
<li><code class="docutils literal notranslate"><span class="pre">range</span></code>: Range handle to map the memory in </li>
<li><code class="docutils literal notranslate"><span class="pre">ram_offset</span></code>: Offset into the block of physical memory of the block to map </li>
<li><code class="docutils literal notranslate"><span class="pre">range_offset</span></code>: Offset into the address range where the block will be mapped </li>
<li><code class="docutils literal notranslate"><span class="pre">len</span></code>: Length of region to map </li>
<li><code class="docutils literal notranslate"><span class="pre">flags</span></code>: One of ESP_HIMEM_MAPFLAG_* </li>
<li><code class="docutils literal notranslate"><span class="pre">out_ptr</span></code>: Pointer to variable to store resulting memory pointer in </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv414esp_himem_free18esp_himem_handle_t">
<span id="_CPPv314esp_himem_free18esp_himem_handle_t"></span><span id="_CPPv214esp_himem_free18esp_himem_handle_t"></span><span id="esp_himem_free__esp_himem_handle_t"></span><span class="target" id="himem_8h_1a9ecfdd55997065e00393b7552cb7aedf"></span><a class="reference internal" href="esp_err.html#_CPPv49esp_err_t" title="esp_err_t">esp_err_t</a> <code class="descname">esp_himem_free</code><span class="sig-paren">(</span><a class="reference internal" href="himem.html#_CPPv418esp_himem_handle_t" title="esp_himem_handle_t">esp_himem_handle_t</a> <em>handle</em><span class="sig-paren">)</span><a class="headerlink" href="himem.html#_CPPv414esp_himem_free18esp_himem_handle_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Free a block of physical memory. </p>
<p>This clears out the associated handle making the memory available for re-allocation again. This will only succeed if none of the memory blocks currently have a mapping.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>- ESP_OK if the memory is succesfully freed<ul class="simple">
<li>ESP_ERR_INVALID_ARG if the handle still is (partially) mapped </li>
</ul>
</dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal notranslate"><span class="pre">handle</span></code>: Handle to the block of memory, as given by esp_himem_alloc </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv424esp_himem_free_map_range23esp_himem_rangehandle_t">
<span id="_CPPv324esp_himem_free_map_range23esp_himem_rangehandle_t"></span><span id="_CPPv224esp_himem_free_map_range23esp_himem_rangehandle_t"></span><span id="esp_himem_free_map_range__esp_himem_rangehandle_t"></span><span class="target" id="himem_8h_1af1c7d4e9074bbb4b5507c0aa268e5e66"></span><a class="reference internal" href="esp_err.html#_CPPv49esp_err_t" title="esp_err_t">esp_err_t</a> <code class="descname">esp_himem_free_map_range</code><span class="sig-paren">(</span><a class="reference internal" href="himem.html#_CPPv423esp_himem_rangehandle_t" title="esp_himem_rangehandle_t">esp_himem_rangehandle_t</a> <em>handle</em><span class="sig-paren">)</span><a class="headerlink" href="himem.html#_CPPv424esp_himem_free_map_range23esp_himem_rangehandle_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Free a mapping range. </p>
<p>This clears out the associated handle making the range available for re-allocation again. This will only succeed if none of the range blocks currently are used for a mapping.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>- ESP_OK if the memory is succesfully freed<ul class="simple">
<li>ESP_ERR_INVALID_ARG if the handle still is (partially) mapped to </li>
</ul>
</dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal notranslate"><span class="pre">handle</span></code>: Handle to the range block, as given by esp_himem_alloc_map_range </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv415esp_himem_unmap23esp_himem_rangehandle_tPv6size_t">
<span id="_CPPv315esp_himem_unmap23esp_himem_rangehandle_tPv6size_t"></span><span id="_CPPv215esp_himem_unmap23esp_himem_rangehandle_tPv6size_t"></span><span id="esp_himem_unmap__esp_himem_rangehandle_t.voidP.s"></span><span class="target" id="himem_8h_1ae7c8ceb84f764994fecb6bbcb685a6d2"></span><a class="reference internal" href="esp_err.html#_CPPv49esp_err_t" title="esp_err_t">esp_err_t</a> <code class="descname">esp_himem_unmap</code><span class="sig-paren">(</span><a class="reference internal" href="himem.html#_CPPv423esp_himem_rangehandle_t" title="esp_himem_rangehandle_t">esp_himem_rangehandle_t</a> <em>range</em>, void *<em>ptr</em>, size_t <em>len</em><span class="sig-paren">)</span><a class="headerlink" href="himem.html#_CPPv415esp_himem_unmap23esp_himem_rangehandle_tPv6size_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Unmap a region. </p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>- ESP_OK if the memory is succesfully unmapped,<ul class="simple">
<li>ESP_ERR_INVALID_ARG if ptr or len are invalid. </li>
</ul>
</dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal notranslate"><span class="pre">range</span></code>: Range handle </li>
<li><code class="docutils literal notranslate"><span class="pre">ptr</span></code>: Pointer returned by esp_himem_map </li>
<li><code class="docutils literal notranslate"><span class="pre">len</span></code>: Length of the block to be unmapped. Must be aligned to the SPI RAM MMU blocksize (32K) </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv423esp_himem_get_phys_sizev">
<span id="_CPPv323esp_himem_get_phys_sizev"></span><span id="_CPPv223esp_himem_get_phys_sizev"></span><span id="esp_himem_get_phys_size__void"></span><span class="target" id="himem_8h_1a426b3b8638d3887eae434f6cb3b2abf4"></span>size_t <code class="descname">esp_himem_get_phys_size</code><span class="sig-paren">(</span>void<span class="sig-paren">)</span><a class="headerlink" href="himem.html#_CPPv423esp_himem_get_phys_sizev" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Get total amount of memory under control of himem API. </p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>Amount of memory, in bytes </dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv423esp_himem_get_free_sizev">
<span id="_CPPv323esp_himem_get_free_sizev"></span><span id="_CPPv223esp_himem_get_free_sizev"></span><span id="esp_himem_get_free_size__void"></span><span class="target" id="himem_8h_1ad694badef410f9b3fb2b2c379e6cfb0d"></span>size_t <code class="descname">esp_himem_get_free_size</code><span class="sig-paren">(</span>void<span class="sig-paren">)</span><a class="headerlink" href="himem.html#_CPPv423esp_himem_get_free_sizev" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Get free amount of memory under control of himem API. </p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>Amount of free memory, in bytes </dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv428esp_himem_reserved_area_sizev">
<span id="_CPPv328esp_himem_reserved_area_sizev"></span><span id="_CPPv228esp_himem_reserved_area_sizev"></span><span id="esp_himem_reserved_area_size__void"></span><span class="target" id="himem_8h_1ae2b1a73bb041c871c7f8e00da8e86922"></span>size_t <code class="descname">esp_himem_reserved_area_size</code><span class="sig-paren">(</span>void<span class="sig-paren">)</span><a class="headerlink" href="himem.html#_CPPv428esp_himem_reserved_area_sizev" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Get amount of SPI memory address space needed for bankswitching. </p>
<p><dl class="docutils">
<dt><strong>Note</strong></dt>
<dd>This is also weakly defined in esp32/spiram.c and returns 0 there, so if no other function in this file is used, no memory is reserved.</dd>
<dt><strong>Return</strong></dt>
<dd>Amount of reserved area, in bytes </dd>
</dl>
</p>
</dd></dl>

</div>
<div class="section" id="macros">
<h3>Macros<a class="headerlink" href="himem.html#macros" title="Permalink to this headline">¶</a></h3>
<dl class="macro">
<dt id="c.ESP_HIMEM_BLKSZ">
<span class="target" id="himem_8h_1af56b115ee3ff422002b91f7d95958547"></span><code class="descname">ESP_HIMEM_BLKSZ</code><a class="headerlink" href="himem.html#c.ESP_HIMEM_BLKSZ" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="c.ESP_HIMEM_MAPFLAG_RO">
<span class="target" id="himem_8h_1abc3e25c02d32184f494b7f7a309eb196"></span><code class="descname">ESP_HIMEM_MAPFLAG_RO</code><a class="headerlink" href="himem.html#c.ESP_HIMEM_MAPFLAG_RO" title="Permalink to this definition">¶</a></dt>
<dd><p>Indicates that a mapping will only be read from. Note that this is unused for now. </p>
</dd></dl>

</div>
<div class="section" id="type-definitions">
<h3>Type Definitions<a class="headerlink" href="himem.html#type-definitions" title="Permalink to this headline">¶</a></h3>
<dl class="type">
<dt id="_CPPv418esp_himem_handle_t">
<span id="_CPPv318esp_himem_handle_t"></span><span id="_CPPv218esp_himem_handle_t"></span><span id="esp_himem_handle_t"></span><span class="target" id="himem_8h_1aa127f767cb2d0859b014228b9e5eaf2a"></span><em class="property">typedef </em><em class="property">struct</em> esp_himem_ramdata_t *<code class="descname">esp_himem_handle_t</code><a class="headerlink" href="himem.html#_CPPv418esp_himem_handle_t" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="type">
<dt id="_CPPv423esp_himem_rangehandle_t">
<span id="_CPPv323esp_himem_rangehandle_t"></span><span id="_CPPv223esp_himem_rangehandle_t"></span><span id="esp_himem_rangehandle_t"></span><span class="target" id="himem_8h_1a27cab3fb02eee2a68a46eb6fd5e82144"></span><em class="property">typedef </em><em class="property">struct</em> esp_himem_rangedata_t *<code class="descname">esp_himem_rangehandle_t</code><a class="headerlink" href="himem.html#_CPPv423esp_himem_rangehandle_t" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ipc.html" class="btn btn-neutral float-right" title="Inter-Processor Call" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="esp_timer.html" class="btn btn-neutral float-left" title="High Resolution Timer" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016 - 2019, Espressif Systems (Shanghai) CO., LTD
      
        <span class="commit">
          Revision <code>f9108063</code>.
        </span>
      

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  



  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
   

</body>
</html>