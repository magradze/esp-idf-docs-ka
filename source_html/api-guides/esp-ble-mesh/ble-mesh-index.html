

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ESP-BLE-MESH &mdash; ESP-IDF Programming Guide v4.1-dev-2071-gf91080637 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script type="text/javascript" src="https://media.readthedocs.com/javascript/readthedocs-doc-embed.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="ESP-BLE-MESH Feature List" href="ble-mesh-feature-list.html" />
    <link rel="prev" title="Error Handling" href="../error-handling.html" /> 

<!-- RTD Extra Head -->

<!-- 
Always link to the latest version, as canonical.
http://docs.readthedocs.org/en/latest/canonical.html
-->
<link rel="canonical" href="https://docs.espressif.com/projects/esp-idf/en/latest/api-guides/esp-ble-mesh/ble-mesh-index.html" />

<link rel="stylesheet" href="https://media.readthedocs.com/css/readthedocs-doc-embed.css" type="text/css" />

<script type="text/javascript" src="../../_static/readthedocs-data.js"></script>

<!-- Add page-specific data, which must exist in the page js, not global -->
<script type="text/javascript">
READTHEDOCS_DATA['page'] = "api-guides/esp-ble-mesh/ble-mesh-index"
READTHEDOCS_DATA['source_suffix'] = ".rst"
</script>

<script type="text/javascript" src="https://media.readthedocs.com/javascript/readthedocs-analytics.js"></script>

<!-- end RTD <extrahead> -->
<script async type="text/javascript" src="../../../../../../_/static/javascript/readthedocs-addons.js"></script><meta name="readthedocs-project-slug" content="espressif-esp-idf" /><meta name="readthedocs-version-slug" content="latest" /><meta name="readthedocs-resolver-filename" content="/api-guides/esp-ble-mesh/ble-mesh-index.html" /><meta name="readthedocs-http-status" content="200" /></head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> ESP-IDF Programming Guide
          

          
            
            <img src="../../_static/espressif-logo.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../get-started/index.html">Get Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api-reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hw-reference/index.html">H/W Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../esp32s2.html">ESP32-S2 Preview Support</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">API Guides</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../app_trace.html">Application Level Tracing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../blufi.html">BluFi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bootloader.html">Bootloader</a></li>
<li class="toctree-l2"><a class="reference internal" href="../build-system.html">Build System</a></li>
<li class="toctree-l2"><a class="reference internal" href="../build-system-legacy.html">Build System (Legacy GNU Make)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../console.html">Console Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deep-sleep-stub.html">Deep Sleep Wake Stubs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../error-handling.html">Error Handling</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="ble-mesh-index.html#">ESP-BLE-MESH</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ble-mesh-index.html#getting-started-with-esp-ble-mesh">Getting Started with ESP-BLE-MESH</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ble-mesh-index.html#what-you-need">What You Need</a></li>
<li class="toctree-l4"><a class="reference internal" href="ble-mesh-index.html#installation-step-by-step">Installation Step by Step</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ble-mesh-index.html#esp-ble-mesh-examples">ESP-BLE-MESH Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="ble-mesh-index.html#esp-ble-mesh-demo-videos">ESP-BLE-MESH Demo Videos</a></li>
<li class="toctree-l3"><a class="reference internal" href="ble-mesh-index.html#esp-ble-mesh-faq">ESP-BLE-MESH FAQ</a></li>
<li class="toctree-l3"><a class="reference internal" href="ble-mesh-index.html#related-documents">Related Documents</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ble-mesh-feature-list.html">ESP-BLE-MESH Feature List</a></li>
<li class="toctree-l4"><a class="reference internal" href="ble-mesh-architecture.html">ESP-BLE-MESH Architecture</a></li>
<li class="toctree-l4"><a class="reference internal" href="ble-mesh-faq.html">ESP-BLE-MESH FAQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="ble-mesh-terminology.html">ESP-BLE-MESH Terminology</a></li>
<li class="toctree-l4"><a class="reference internal" href="ble-mesh-index.html#bluetooth-sig-documentation">Bluetooth SIG Documentation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../mesh.html">ESP-MESH (Wi-Fi)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core_dump.html">ESP32 Core Dump</a></li>
<li class="toctree-l2"><a class="reference internal" href="../event-handling.html">Event Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../external-ram.html">External SPI-connected RAM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fatal-errors.html">Fatal Errors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../security/flash-encryption.html">Flash Encryption</a></li>
<li class="toctree-l2"><a class="reference internal" href="../freertos-smp.html">FreeRTOS SMP Changes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general-notes.html">General Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hlinterrupts.html">High Level Interrupts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jtag-debugging/index.html">JTAG Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../linker-script-generation.html">Linker Script Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lwip.html">lwIP TCP/IP Stack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../partition-tables.html">Partition Tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../RF_calibration.html">RF Calibration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../romconsole.html">ROM debug console</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../security/secure-boot.html">Secure Boot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../thread-local-storage.html">Thread Local Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tools/index.html">Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ulp.html">ULP Coprocessor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ulp-legacy.html">ULP Coprocessor (Legacy GNU Make)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit-tests-legacy.html">Unit Testing (Legacy GNU Make)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit-tests.html">Unit Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../wifi.html">WiFi Driver</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../libraries-and-frameworks/index.html">Libraries and Frameworks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contribute/index.html">Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../versions.html">Versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources.html">Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COPYRIGHT.html">Copyrights</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../languages.html">语言/Languages</a></li>
<li class="toctree-l1"><a class="reference external" href="https://readthedocs.com/projects/espressif-esp-idf/downloads/">Guide Downloads</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">ESP-IDF Programming Guide</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">API Guides</a> &raquo;</li>
        
      <li>ESP-BLE-MESH</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/espressif/esp-idf/blob/master/docs/en/api-guides/esp-ble-mesh/ble-mesh-index.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="esp-ble-mesh">
<h1>ESP-BLE-MESH<a class="headerlink" href="ble-mesh-index.html#esp-ble-mesh" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="https://espressif-docs.readthedocs-hosted.com/projects/esp-idf/zh_CN/latest/api-guides/esp-ble-mesh/ble-mesh-index.html">[中文]</a></p>
<p>Bluetooth® mesh networking enables many-to-many (m:m) device communications and is optimized for creating large-scale device networks.</p>
<p>Devices may relay data to other devices not in direct radio range of the originating device. In this way, mesh networks can span very large physical areas and contain large numbers of devices. It is ideally suited for building automation, sensor networks, and other IoT solutions where tens, hundreds, or thousands of devices need to reliably and securely communicate with one another.</p>
<p>Bluetooth mesh is not a wireless communications technology, but a networking technology. This technology is dependent upon Bluetooth Low Energy (BLE) - a wireless communications protocol stack.</p>
<p>Built on top of Zephyr Bluetooth Mesh stack, the ESP-BLE-MESH implementation supports device provisioning and node control. It also supports such node features as Proxy, Relay, Low power and Friend.</p>
<p>Please see the <a class="reference internal" href="ble-mesh-architecture.html"><span class="doc">ESP-BLE-MESH Architecture</span></a> for information about the implementation of ESP-BLE-MESH architecture and <a class="reference internal" href="../../api-reference/bluetooth/esp-ble-mesh.html"><span class="doc">ESP-BLE-MESH API Reference</span></a> for information about respective API.</p>
<p>ESP-BLE-MESH is implemented and certified based on the latest Mesh Profile v1.0.1, users can refer <a class="reference external" href="https://launchstudio.bluetooth.com/ListingDetails/94304">here</a> for the certification details of ESP-BLE-MESH.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you are looking for Wi-Fi based implementation of mesh for ESP32, please check another product by Espressif called ESP-MESH. For more information and documentation see <a class="reference internal" href="../../api-reference/network/esp_mesh.html"><span class="doc">ESP-MESH</span></a>.</p>
</div>
<div class="section" id="getting-started-with-esp-ble-mesh">
<span id="getting-started-with-ble-mesh"></span><h2>Getting Started with ESP-BLE-MESH<a class="headerlink" href="ble-mesh-index.html#getting-started-with-esp-ble-mesh" title="Permalink to this headline">¶</a></h2>
<p>This section is intended to help you get started with ESP-BLE-MESH for the hardware based on the ESP32 chip by Espressif.</p>
<p>We are going to demonstrate process of setting and operation of a small ESP-BLE-MESH network of three nodes. This process will cover device provisioning and node configuration, and then sending on/off commands to Generic OnOff Server Models on specific nodes.</p>
<p>If you are new to ESP-IDF, please first set up development environment, compile , flash and run example application following top level ESP-IDF <a class="reference internal" href="../../get-started/index.html"><span class="doc">Get Started</span></a> documentation.</p>
<div class="section" id="what-you-need">
<h3>What You Need<a class="headerlink" href="ble-mesh-index.html#what-you-need" title="Permalink to this headline">¶</a></h3>
<p>Hardware:</p>
<ul class="simple">
<li>Three ESP32 boards, see <a class="reference internal" href="ble-mesh-index.html#get-started-ble-mesh-check-hardware"><span class="std std-ref">options</span></a>.</li>
<li>USB cables to connect the boards.</li>
<li>Computer configured with ESP-IDF.</li>
<li>Mobile phone or tablet running Android or iOS.</li>
</ul>
<p>Software:</p>
<ul>
<li><p class="first">Example application <a class="reference external" href="https://github.com/espressif/esp-idf/tree/f91080637/examples/bluetooth/esp_ble_mesh/ble_mesh_node/onoff_server">bluetooth/esp_ble_mesh/ble_mesh_node/onoff_server</a> code to load to the ESP32 boards.</p>
</li>
<li><p class="first">Mobile App: <strong>nRF Mesh</strong> for Android or iOS. Optionally you can use some other Apps:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="https://github.com/EspressifApp/EspBLEMeshForAndroid/releases/tag/v1.0.0">EspBleMesh</a> Android App</li>
<li>Silicon Labs Android or iOS App</li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="installation-step-by-step">
<h3>Installation Step by Step<a class="headerlink" href="ble-mesh-index.html#installation-step-by-step" title="Permalink to this headline">¶</a></h3>
<p>This is a detailed roadmap to walk you through the installation process.</p>
<div class="section" id="step-1-check-hardware">
<span id="get-started-ble-mesh-check-hardware"></span><h4>Step 1. Check Hardware<a class="headerlink" href="ble-mesh-index.html#step-1-check-hardware" title="Permalink to this headline">¶</a></h4>
<p>Both <a class="reference external" href="https://www.espressif.com/en/products/hardware/esp32-devkitc/overview">ESP32-DevKitC</a> and <a class="reference external" href="https://www.espressif.com/en/products/hardware/esp-wrover-kit/overview">ESP-WROVER-KIT</a> development boards are supported for ESP-BLE-MESH implementation. You can choose particular board through menuconfig: <code class="code docutils literal notranslate"><span class="pre">idf.py</span> <span class="pre">menuconfig</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">Example</span> <span class="pre">Configuration</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">Board</span> <span class="pre">selection</span> <span class="pre">for</span> <span class="pre">ESP-BLE-MESH</span></code></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you plan to use <a class="reference external" href="https://www.espressif.com/en/products/hardware/esp32-devkitc/overview">ESP32-DevKitC</a>, connect a RGB LED to GPIO pins 25, 26 and 27.</p>
</div>
</div>
<div class="section" id="step-2-configure-software">
<h4>Step 2. Configure Software<a class="headerlink" href="ble-mesh-index.html#step-2-configure-software" title="Permalink to this headline">¶</a></h4>
<p>Enter the <a class="reference external" href="https://github.com/espressif/esp-idf/tree/f91080637/examples/bluetooth/esp_ble_mesh/ble_mesh_node/onoff_server">bluetooth/esp_ble_mesh/ble_mesh_node/onoff_server</a> example directory, run <code class="code docutils literal notranslate"><span class="pre">idf.py</span> <span class="pre">menuconfig</span></code> to select your board and then run <code class="code docutils literal notranslate"><span class="pre">idf.py</span> <span class="pre">build</span></code> to compile the example.</p>
</div>
<div class="section" id="step-3-upload-application-to-nodes">
<h4>Step 3. Upload Application to Nodes<a class="headerlink" href="ble-mesh-index.html#step-3-upload-application-to-nodes" title="Permalink to this headline">¶</a></h4>
<p>After the <a class="reference external" href="https://github.com/espressif/esp-idf/tree/f91080637/examples/bluetooth/esp_ble_mesh/ble_mesh_node/onoff_server">bluetooth/esp_ble_mesh/ble_mesh_node/onoff_server</a> example is compiled successfully, users can run <code class="code docutils literal notranslate"><span class="pre">idf.py</span> <span class="pre">flash</span></code> to upload the same generated binary files into each of the three development boards.</p>
<p>Once boards are powered on, the RGB LED on each board should turn <strong>GREEN</strong>.</p>
<div class="figure align-center" id="id3">
<img alt="../../_images/ble-mesh-device-power-on.png" src="../../_images/ble-mesh-device-power-on.png" />
<p class="caption"><span class="caption-text">ESP-BLE-MESH Devices Power On</span></p>
</div>
</div>
<div class="section" id="step-4-provision-nodes">
<h4>Step 4. Provision Nodes<a class="headerlink" href="ble-mesh-index.html#step-4-provision-nodes" title="Permalink to this headline">¶</a></h4>
<p>In this section, we will use the <strong>nRF Mesh Android</strong> App to demonstrate how to provision an unprovisioned device. Users can also get its iOS version from the App Store.</p>
<div class="section" id="scanner">
<h5>4.1 Scanner<a class="headerlink" href="ble-mesh-index.html#scanner" title="Permalink to this headline">¶</a></h5>
<p>The Scanner is App’s functionality to search for unprovisioned devices in range. Open the App, press <strong>Scanner</strong> at the bottom and the search will start. After a short while we should see three unprovisioned devices displayed.</p>
<div class="figure align-center" id="id4">
<a class="reference internal image-reference" href="../../_images/ble-mesh-scanner.png"><img alt="../../_images/ble-mesh-scanner.png" src="../../_images/ble-mesh-scanner.png" style="height: 370px;" /></a>
<p class="caption"><span class="caption-text">nRF Mesh - Scanner</span></p>
</div>
</div>
<div class="section" id="identify">
<h5>4.2 Identify<a class="headerlink" href="ble-mesh-index.html#identify" title="Permalink to this headline">¶</a></h5>
<p>Users can select any unprovisioned device, then the App will try to set up a connection with the selected device. After the BLE connection is established successfully (sometimes users need to try multiple times to get connected), and proper ESP-BLE-MESH GATT Service is discovered, users can see the <strong>IDENTIFY</strong> interface button on the screen. The IDENTIFY operation can be used to tell users which device is going to be provisioned.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The IDENTIFY operation also needs some cooperation on the device side, then users can see which device is in the provisioning process. Currently when pressing the <strong>IDENTIFY</strong> interface button, no signs can been seen from the device except from the log on the serial monitor.</p>
</div>
<p>After the <strong>IDENTIFY</strong> interface button is pressed, users can see the <strong>PROVISION</strong> interface button.</p>
<div class="figure align-center" id="id5">
<a class="reference internal image-reference" href="../../_images/ble-mesh-identify-provision.png"><img alt="../../_images/ble-mesh-identify-provision.png" src="../../_images/ble-mesh-identify-provision.png" style="height: 370px;" /></a>
<p class="caption"><span class="caption-text">nRF Mesh - IDENTIFY - PROVISION</span></p>
</div>
</div>
<div class="section" id="provision">
<h5>4.3 Provision<a class="headerlink" href="ble-mesh-index.html#provision" title="Permalink to this headline">¶</a></h5>
<p>Then, the App will try to provision the unprovisioned device. When the device is provisioned successfully, the RGB LED on the board will turn off, and the App will implement the following procedures:</p>
<ol class="arabic simple">
<li>Disconnect with the node</li>
<li>Try to reconnect with the node</li>
<li>Connect successfully and discover ESP-BLE-MESH GATT Service</li>
<li>Get Composition Data of the node and add AppKey to it</li>
</ol>
<p>When all the procedures are finished, the node is configured properly. And after pressing <strong>OK</strong>, users can see that unicast address is assigned, and Composition Data of the node is decoded successfully.</p>
<div class="figure align-center" id="id6">
<a class="reference internal image-reference" href="../../_images/ble-mesh-config-complete.png"><img alt="../../_images/ble-mesh-config-complete.png" src="../../_images/ble-mesh-config-complete.png" style="height: 370px;" /></a>
<p class="caption"><span class="caption-text">nRF Mesh - Configuration Complete</span></p>
</div>
<p>Sometimes in procedure 2, the App may fail to reconnect with the node. In this case, after pressing <strong>OK</strong>, users can see that only unicast address of the node has been assigned, but no Composition Data has been got. Then users need to press <strong>CONNECT</strong> on the top right, and the previously provisioned node will be displayed on the screen, and users need to choose it and try to connect with the node.</p>
<div class="figure align-center" id="id7">
<a class="reference internal image-reference" href="../../_images/ble-mesh-initial-config-fail.png"><img alt="../../_images/ble-mesh-initial-config-fail.png" src="../../_images/ble-mesh-initial-config-fail.png" style="height: 370px;" /></a>
<p class="caption"><span class="caption-text">nRF Mesh - Initial Configuration Failed</span></p>
</div>
<p>After connecting successfully, the App will show the interface buttons which can be used to get Composition Data and add AppKey.</p>
<div class="figure align-center" id="id8">
<a class="reference internal image-reference" href="../../_images/ble-mesh-reconnect-initial-config.png"><img alt="../../_images/ble-mesh-reconnect-initial-config.png" src="../../_images/ble-mesh-reconnect-initial-config.png" style="height: 370px;" /></a>
<p class="caption"><span class="caption-text">nRF Mesh - Reconnect - Initial Configuration</span></p>
</div>
<p>If the device is the second or the third one which has been provisioned by the App, and after pressing <strong>CONNECT</strong>, users can see two or three nodes on the screen. In this situation, users can choose any device to connect with, once succeed then go back to the main screen to choose the node which needs to be configured.</p>
<p>Here an example of three devices listed.</p>
<ul class="simple">
<li>The left picture shows that the third device is provisioned successfully, but the App failed to connect with it. When it tries to reconnect with the third node, three nodes are displayed on the App.</li>
<li>The right picture shows that after connecting with any node successfully, the App displays the information of the three nodes. Users can see that the App has got the Composition Data of the first and the second nodes, but for the third one, only the unicast address has been assigned to it while the Composition Data is unknown.</li>
</ul>
<div class="figure align-center" id="id9">
<a class="reference internal image-reference" href="../../_images/ble-mesh-reconnect-three.png"><img alt="../../_images/ble-mesh-reconnect-three.png" src="../../_images/ble-mesh-reconnect-three.png" style="height: 370px;" /></a>
<p class="caption"><span class="caption-text">nRF Mesh - Reconnect - Three Nodes</span></p>
</div>
</div>
<div class="section" id="configuration">
<h5>4.4 Configuration<a class="headerlink" href="ble-mesh-index.html#configuration" title="Permalink to this headline">¶</a></h5>
<p>When provisioning and initial configuration are finished, users can start to configure the node, such as binding AppKey with each model with the elements, setting publication information to it, etc.</p>
<p>Example below shows how to bind AppKey with Generic OnOff Server Model within the Primary Element.</p>
<div class="figure align-center" id="id10">
<a class="reference internal image-reference" href="../../_images/ble-mesh-model-bind-appkey.png"><img alt="../../_images/ble-mesh-model-bind-appkey.png" src="../../_images/ble-mesh-model-bind-appkey.png" style="height: 370px;" /></a>
<p class="caption"><span class="caption-text">nRF Mesh - Model Bind AppKey</span></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">No need to bind AppKey with the Configuration Server Model, since it only uses the DevKey to encrypt messages in the Upper Transport Layer.</p>
</div>
</div>
</div>
<div class="section" id="step-5-operate-network">
<h4>Step 5. Operate Network<a class="headerlink" href="ble-mesh-index.html#step-5-operate-network" title="Permalink to this headline">¶</a></h4>
<p>After all the Generic OnOff Server Models within the three elements are bound with proper AppKey, users can use the App to turn on/off the RGB LED.</p>
<p>In the <a class="reference external" href="https://github.com/espressif/esp-idf/tree/f91080637/examples/bluetooth/esp_ble_mesh/ble_mesh_node/onoff_server">bluetooth/esp_ble_mesh/ble_mesh_node/onoff_server</a> example, the first Generic OnOff Server Model is used to control the <strong>RED</strong> color, the second one is used to control the <strong>GREEN</strong> color and the third one is used to control the <strong>BLUE</strong> color.</p>
<div class="figure align-center" id="id11">
<a class="reference internal image-reference" href="../../_images/ble-mesh-generic-onoff.png"><img alt="../../_images/ble-mesh-generic-onoff.png" src="../../_images/ble-mesh-generic-onoff.png" style="height: 370px;" /></a>
<p class="caption"><span class="caption-text">nRF Mesh - Generic OnOff Control</span></p>
</div>
<p>The following screenshot shows different board with different color on.</p>
<div class="figure align-center" id="id12">
<img alt="../../_images/ble-mesh-three-nodes-on.png" src="../../_images/ble-mesh-three-nodes-on.png" />
<p class="caption"><span class="caption-text">Three ESP-BLE-MESH Nodes On</span></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For <strong>nRF Mesh</strong> iOS App [version 1.0.4], when the node contains more than one element, the App is not behaving correctly. If users try to turn on/off the second or the third Generic OnOff Server Model, the message sent by the App is destinated to the first Generic OnOff Server Model within the Primary Element.</p>
</div>
</div>
</div>
</div>
<div class="section" id="esp-ble-mesh-examples">
<span id="id1"></span><h2>ESP-BLE-MESH Examples<a class="headerlink" href="ble-mesh-index.html#esp-ble-mesh-examples" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="https://github.com/espressif/esp-idf/tree/f91080637/examples/bluetooth/esp_ble_mesh/ble_mesh_node/onoff_server/tutorial/BLE_Mesh_Node_OnOff_Server_Example_Walkthrough.md">ESP-BLE-MESH Node OnOff Server </a> - shows the use of ESP-BLE-MESH as a node having a Configuration Server model and a Generic OnOff Server model. A ESP-BLE-MESH Provisioner can then provision the unprovisioned device and control a RGB LED representing on/off state, see <a class="reference external" href="https://github.com/espressif/esp-idf/tree/f91080637/examples/bluetooth/esp_ble_mesh/ble_mesh_node/onoff_server">example code </a>.</li>
<li><a class="reference external" href="https://github.com/espressif/esp-idf/tree/f91080637/examples/bluetooth/esp_ble_mesh/ble_mesh_node/onoff_client/tutorial/BLE_Mesh_Node_OnOff_Client_Example_Walkthrough.md">ESP-BLE-MESH Node OnOff Client </a> - shows how a Generic OnOff Client model works within a node. The node has a Configuration Server model and a Generic OnOff Client model, see <a class="reference external" href="https://github.com/espressif/esp-idf/tree/f91080637/examples/bluetooth/esp_ble_mesh/ble_mesh_node/onoff_client">example code </a>.</li>
<li><a class="reference external" href="https://github.com/espressif/esp-idf/tree/f91080637/examples/bluetooth/esp_ble_mesh/ble_mesh_provisioner/tutorial/BLE_Mesh_Provisioner_Example_Walkthrough.md">ESP-BLE-MESH Provisioner </a> - shows how a device can act as an ESP-BLE-MESH Provisioner to provision devices. The Provisioner has a Configuration Server model, a Configuration Client model and a Generic OnOff Client model, see <a class="reference external" href="https://github.com/espressif/esp-idf/tree/f91080637/examples/bluetooth/esp_ble_mesh/ble_mesh_provisioner">example code </a>.</li>
<li>ESP-BLE-MESH Fast Provisioning - <a class="reference external" href="https://github.com/espressif/esp-idf/tree/f91080637/examples/bluetooth/esp_ble_mesh/ble_mesh_fast_provision/ble_mesh_fast_prov_client/tutorial/BLE_Mesh_Fast_Prov_Client_Example_Walkthrough.md">Client </a> and <a class="reference external" href="https://github.com/espressif/esp-idf/tree/f91080637/examples/bluetooth/esp_ble_mesh/ble_mesh_fast_provision/ble_mesh_fast_prov_server/tutorial/BLE_Mesh_Fast_Prov_Server_Example_Walkthrough.md">Server </a> - this example is used for showing how fast provisioning can be used in order to create a mesh network. It takes no more than 60 seconds to provision 100 devices, see <a class="reference external" href="https://github.com/espressif/esp-idf/tree/f91080637/examples/bluetooth/esp_ble_mesh/ble_mesh_fast_provision/ble_mesh_fast_prov_client">example client code </a> and <a class="reference external" href="https://github.com/espressif/esp-idf/tree/f91080637/examples/bluetooth/esp_ble_mesh/ble_mesh_fast_provision/ble_mesh_fast_prov_server">example server code </a>.</li>
<li><a class="reference external" href="https://github.com/espressif/esp-idf/tree/f91080637/examples/bluetooth/esp_ble_mesh/ble_mesh_wifi_coexist/tutorial/BLE_Mesh_WiFi_Coexist_Example_Walkthrough.md">ESP-BLE-MESH and Wi-Fi Coexistence </a> - an example that demonstrates the Wi-Fi and Bluetooth (BLE/BR/EDR) coexistence feature of ESP32. Simply put, users can use the Wi-Fi while operating Bluetooth, see <a class="reference external" href="https://github.com/espressif/esp-idf/tree/f91080637/examples/bluetooth/esp_ble_mesh/ble_mesh_wifi_coexist">example code </a>.</li>
<li>ESP-BLE-MESH Node Console - an example that implements BLE Mesh node basic features. Within this example a node can be scanned and provisioned by Provisioner and reply to get/set message from Provisioner, see <a class="reference external" href="https://github.com/espressif/esp-idf/tree/f91080637/examples/bluetooth/esp_ble_mesh/ble_mesh_console/ble_mesh_node">example node code </a> and <a class="reference external" href="https://github.com/espressif/esp-idf/tree/f91080637/examples/bluetooth/esp_ble_mesh/ble_mesh_console/ble_mesh_provisioner">example Provisioner code </a>.</li>
</ul>
</div>
<div class="section" id="esp-ble-mesh-demo-videos">
<span id="id2"></span><h2>ESP-BLE-MESH Demo Videos<a class="headerlink" href="ble-mesh-index.html#esp-ble-mesh-demo-videos" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="http://download.espressif.com/BLE_MESH/Docs4Customers/esp-ble-mesh-demo.mp4">Provisioning of ESP-BLE-MESH nodes using Smartphone App</a></li>
<li><a class="reference external" href="http://download.espressif.com/BLE_MESH/BLE_Mesh_Demo/V0.4_Demo_Fast_Provision/ESP32_BLE_Mesh_Fast_Provision.mp4">Espressif Fast Provisioning using ESP-BLE-MESH App</a></li>
<li><a class="reference external" href="http://download.espressif.com/BLE_MESH/BLE_Mesh_Demo/V0.5_Demo_Coexistence/ESP_BLE_MESH_%26_WIFI_Coexistence.mp4">Espressif ESP-BLE-MESH and Wi-Fi Coexistence</a></li>
</ul>
</div>
<div class="section" id="esp-ble-mesh-faq">
<h2>ESP-BLE-MESH FAQ<a class="headerlink" href="ble-mesh-index.html#esp-ble-mesh-faq" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference internal" href="ble-mesh-faq.html#ble-mesh-faq-provisioner-development"><span class="std std-ref">1. Provisioner Development</span></a></li>
<li><a class="reference internal" href="ble-mesh-faq.html#ble-mesh-faq-node-development"><span class="std std-ref">2. Node Development</span></a></li>
<li><a class="reference internal" href="ble-mesh-faq.html#ble-mesh-faq-ble-mesh-and-wi-fi-coexistence"><span class="std std-ref">3. ESP-BLE-MESH and Wi-Fi Coexistence</span></a></li>
<li><a class="reference internal" href="ble-mesh-faq.html#ble-mesh-faq-fast-provisioning"><span class="std std-ref">4. Fast Provisioning</span></a></li>
<li><a class="reference internal" href="ble-mesh-faq.html#ble-mesh-faq-log-help"><span class="std std-ref">5. Log Help</span></a></li>
<li><a class="reference internal" href="ble-mesh-faq.html#ble-mesh-faq-example-help"><span class="std std-ref">6. Example Help</span></a></li>
<li><a class="reference internal" href="ble-mesh-faq.html#ble-mesh-faq-others"><span class="std std-ref">7. Others</span></a></li>
</ul>
</div>
<div class="section" id="related-documents">
<h2>Related Documents<a class="headerlink" href="ble-mesh-index.html#related-documents" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="ble-mesh-feature-list.html">ESP-BLE-MESH Feature List</a></li>
<li class="toctree-l1"><a class="reference internal" href="ble-mesh-architecture.html">ESP-BLE-MESH Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="ble-mesh-faq.html">ESP-BLE-MESH FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="ble-mesh-terminology.html">ESP-BLE-MESH Terminology</a></li>
</ul>
</div>
<div class="section" id="bluetooth-sig-documentation">
<h3>Bluetooth SIG Documentation<a class="headerlink" href="ble-mesh-index.html#bluetooth-sig-documentation" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference external" href="https://www.bluetooth.org/docman/handlers/downloaddoc.ashx?doc_id=429633">BLE Mesh Core Specification</a></li>
<li><a class="reference external" href="https://www.bluetooth.org/docman/handlers/downloaddoc.ashx?doc_id=429634">BLE Mesh Model Specification</a></li>
<li><a class="reference external" href="http://blog.bluetooth.com/an-intro-to-bluetooth-mesh-part1">An Intro to Bluetooth Mesh Part 1</a> / <a class="reference external" href="http://blog.bluetooth.com/an-intro-to-bluetooth-mesh-part2">Part 2</a></li>
<li><a class="reference external" href="http://blog.bluetooth.com/the-fundamental-concepts-of-bluetooth-mesh-networking-part-1">The Fundamental Concepts of Bluetooth Mesh Networking, Part 1</a> / <a class="reference external" href="http://blog.bluetooth.com/the-fundamental-concepts-of-bluetooth-mesh-networking-part-2">Part 2</a></li>
<li><a class="reference external" href="http://blog.bluetooth.com/bluetooth-mesh-networking-series-friendship">Bluetooth Mesh Networking: Friendship</a></li>
<li><a class="reference external" href="http://blog.bluetooth.com/management-of-devices-bluetooth-mesh-network">Management of Devices in a Bluetooth Mesh Network</a></li>
<li><a class="reference external" href="http://blog.bluetooth.com/bluetooth-mesh-security-overview">Bluetooth Mesh Security Overview</a></li>
<li><a class="reference external" href="http://blog.bluetooth.com/provisioning-a-bluetooth-mesh-network-part-1">Provisioning a Bluetooth Mesh Network Part 1</a> / <a class="reference external" href="http://blog.bluetooth.com/provisioning-a-bluetooth-mesh-network-part-2">Part 2</a></li>
</ul>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ble-mesh-feature-list.html" class="btn btn-neutral float-right" title="ESP-BLE-MESH Feature List" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../error-handling.html" class="btn btn-neutral float-left" title="Error Handling" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016 - 2019, Espressif Systems (Shanghai) CO., LTD
      
        <span class="commit">
          Revision <code>f9108063</code>.
        </span>
      

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  



  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
   

</body>
</html>