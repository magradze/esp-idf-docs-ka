
<!DOCTYPE html>

<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>ძაფების ლოკალური საცავი — ESP-IDF პროგრამირების სახელმძღვანელო v4.1-dev-2071-gf91080637 დოკუმენტაცია</title>
<script src="../_static/js/modernizr.min.js" type="text/javascript"></script>
<script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js" type="text/javascript"></script>
<script src="../_static/jquery.js" type="text/javascript"></script>
<script src="../_static/underscore.js" type="text/javascript"></script>
<script src="../_static/doctools.js" type="text/javascript"></script>
<script src="../_static/language_data.js" type="text/javascript"></script>
<script src="https://media.readthedocs.com/javascript/readthedocs-doc-embed.js" type="text/javascript"></script>
<script src="../_static/js/theme.js" type="text/javascript"></script>
<link href="../_static/css/theme.css" rel="stylesheet" type="text/css"/>
<link href="../_static/pygments.css" rel="stylesheet" type="text/css"/>
<link href="../_static/theme_overrides.css" rel="stylesheet" type="text/css"/>
<link href="../about.html" rel="author" title="About these documents"/>
<link href="../genindex.html" rel="index" title="Index"/>
<link href="../search.html" rel="search" title="Search"/>
<link href="tools/index.html" rel="next" title="Tools"/>
<link href="../security/secure-boot.html" rel="prev" title="Secure Boot"/>
<!-- RTD Extra Head -->
<!-- 
Always link to the latest version, as canonical.
http://docs.readthedocs.org/en/latest/canonical.html
-->
<link href="https://docs.espressif.com/projects/esp-idf/en/latest/api-guides/thread-local-storage.html" rel="canonical"/>
<link href="https://media.readthedocs.com/css/readthedocs-doc-embed.css" rel="stylesheet" type="text/css"/>
<script src="../_static/readthedocs-data.js" type="text/javascript"></script>
<!-- Add page-specific data, which must exist in the page js, not global -->
<script type="text/javascript">
READTHEDOCS_DATA['page'] = "api-guides/thread-local-storage"
READTHEDOCS_DATA['source_suffix'] = ".rst"
</script>
<script src="https://media.readthedocs.com/javascript/readthedocs-analytics.js" type="text/javascript"></script>
<!-- end RTD <extrahead> -->
<script async="" src="../../../../../_/static/javascript/readthedocs-addons.js" type="text/javascript"></script><meta content="espressif-esp-idf" name="readthedocs-project-slug"><meta content="latest" name="readthedocs-version-slug"><meta content="/api-guides/thread-local-storage.html" name="readthedocs-resolver-filename"/><meta content="200" name="readthedocs-http-status"/></meta></meta></head>
<body class="wy-body-for-nav">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a class="icon icon-home" href="../index.html"> ESP-IDF პროგრამირების სახელმძღვანელო
          

          
            
            <img alt="Logo" class="logo" src="../_static/espressif-logo.svg"/>
</a>
<div class="version">
                latest
              </div>
<div role="search">
<form action="../search.html" class="wy-form" id="rtd-search-form" method="get">
<input name="q" placeholder="Search docs" type="text"/>
<input name="check_keywords" type="hidden" value="yes"/>
<input name="area" type="hidden" value="default"/>
</form>
</div>
</div>
<div aria-label="main navigation" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../get-started/index.html">დაწყება</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api-reference/index.html">API მითითება</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hw-reference/index.html">ტექნიკის/საშუალებების მითითება</a></li>
<li class="toctree-l1"><a class="reference internal" href="../esp32s2.html">ESP32-S2-ის წინასწარი გადახედვის მხარდაჭერა</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API სახელმძღვანელოები</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="app_trace.html">აპლიკაციის დონის ტრასირება</a></li>
<li class="toctree-l2"><a class="reference internal" href="blufi.html">BluFi</a></li>
<li class="toctree-l2"><a class="reference internal" href="bootloader.html">ჩატვირთვის სისტემა</a></li>
<li class="toctree-l2"><a class="reference internal" href="build-system.html">სისტემის შექმნა</a></li>
<li class="toctree-l2"><a class="reference internal" href="build-system-legacy.html">სისტემის შექმნა (Legacy GNU Make)</a></li>
<li class="toctree-l2"><a class="reference internal" href="console.html">კონსოლის კომპონენტი</a></li>
<li class="toctree-l2"><a class="reference internal" href="deep-sleep-stub.html">ღრმა ძილის გაღვიძების სტატიები</a></li>
<li class="toctree-l2"><a class="reference internal" href="error-handling.html">შეცდომების დამუშავება</a></li>
<li class="toctree-l2"><a class="reference internal" href="esp-ble-mesh/ble-mesh-index.html">ESP-BLE-MESH</a></li>
<li class="toctree-l2"><a class="reference internal" href="mesh.html">ESP-MESH ( Wi-Fi )</a></li>
<li class="toctree-l2"><a class="reference internal" href="core_dump.html">ESP32 ბირთვის ნაგავსაყრელი</a></li>
<li class="toctree-l2"><a class="reference internal" href="event-handling.html">მოვლენების დამუშავება</a></li>
<li class="toctree-l2"><a class="reference internal" href="external-ram.html">გარე SPI-თან დაკავშირებული ოპერატიული მეხსიერება</a></li>
<li class="toctree-l2"><a class="reference internal" href="fatal-errors.html">ფატალური შეცდომები</a></li>
<li class="toctree-l2"><a class="reference internal" href="../security/flash-encryption.html">ფლეშ დაშიფვრა</a></li>
<li class="toctree-l2"><a class="reference internal" href="freertos-smp.html">უფასო RTOS SMP ცვლილებები</a></li>
<li class="toctree-l2"><a class="reference internal" href="general-notes.html">ზოგადი შენიშვნები</a></li>
<li class="toctree-l2"><a class="reference internal" href="hlinterrupts.html">მაღალი დონის შეფერხებები</a></li>
<li class="toctree-l2"><a class="reference internal" href="jtag-debugging/index.html">JTAG-ის გამართვა</a></li>
<li class="toctree-l2"><a class="reference internal" href="linker-script-generation.html">ლინკერის სკრიპტის გენერირება</a></li>
<li class="toctree-l2"><a class="reference internal" href="lwip.html">lwIP TCP/IP სტეკი</a></li>
<li class="toctree-l2"><a class="reference internal" href="partition-tables.html">დანაყოფის ცხრილები</a></li>
<li class="toctree-l2"><a class="reference internal" href="RF_calibration.html">რადიოსიხშირული კალიბრაცია</a></li>
<li class="toctree-l2"><a class="reference internal" href="romconsole.html">ROM გამართვა კონსოლი</a></li>
<li class="toctree-l2"><a class="reference internal" href="../security/secure-boot.html">უსაფრთხო ჩატვირთვა</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="thread-local-storage.html#">ძაფების ლოკალური საცავი</a><ul>
<li class="toctree-l3"><a class="reference internal" href="thread-local-storage.html#overview">მიმოხილვა</a></li>
<li class="toctree-l3"><a class="reference internal" href="thread-local-storage.html#freertos-native-api">თავისუფალი RTOS მშობლიური API</a></li>
<li class="toctree-l3"><a class="reference internal" href="thread-local-storage.html#pthread-api">Pthread API</a></li>
<li class="toctree-l3"><a class="reference internal" href="thread-local-storage.html#c11-standard">C11 სტანდარტი</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tools/index.html">ხელსაწყოები</a></li>
<li class="toctree-l2"><a class="reference internal" href="ulp.html">ULP კოპროცესორი</a></li>
<li class="toctree-l2"><a class="reference internal" href="ulp-legacy.html">ULP კოპროცესორი (Legacy GNU Make)</a></li>
<li class="toctree-l2"><a class="reference internal" href="unit-tests-legacy.html">ერთეულის ტესტირება (Legacy GNU Make)</a></li>
<li class="toctree-l2"><a class="reference internal" href="unit-tests.html">ერთეულის ტესტირება</a></li>
<li class="toctree-l2"><a class="reference internal" href="wifi.html">WiFi დრაივერი</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../libraries-and-frameworks/index.html">ბიბლიოთეკები და ჩარჩოები</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute/index.html">წვლილი შეიტანეთ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../versions.html">ვერსიები</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources.html">რესურსები</a></li>
<li class="toctree-l1"><a class="reference internal" href="../COPYRIGHT.html">საავტორო უფლებები</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">შესახებ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../languages.html">语言/ენები</a></li>
<li class="toctree-l1"><a class="reference external" href="https://readthedocs.com/projects/espressif-esp-idf/downloads/">სახელმძღვანელოს ჩამოტვირთვები</a></li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift">
<nav aria-label="top navigation" class="wy-nav-top">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="../index.html">ESP-IDF პროგრამირების სახელმძღვანელო</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content">
<div aria-label="breadcrumbs navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a href="../index.html">დოკუმენტები</a> »</li>
<li><a href="index.html">API სახელმძღვანელოები</a> »</li>
<li>ძაფების ლოკალური საცავი</li>
<li class="wy-breadcrumbs-aside">
<a class="fa fa-github" href="https://github.com/espressif/esp-idf/blob/master/docs/en/api-guides/thread-local-storage.rst"> რედაქტირება GitHub-ზე</a>
</li>
</ul>
<hr/>
</div>
<div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<div itemprop="articleBody">
<div class="section" id="thread-local-storage">
<h1>ძაფების ლოკალური საცავი<a class="headerlink" href="thread-local-storage.html#thread-local-storage" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>მიმოხილვა<a class="headerlink" href="thread-local-storage.html#overview" title="Permalink to this headline">¶</a></h2>
<p>ძაფ-ლოკალური შენახვა (TLS) არის მექანიზმი, რომლის მეშვეობითაც ცვლადები ისეა განაწილებული, რომ თითოეულ არსებულ ძაფზე ცვლადის ერთი ეგზემპლარი იყოს. ESP-IDF ასეთი ცვლადების გამოყენების სამ გზას გვთავაზობს:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="thread-local-storage.html#freertos-native"><span class="std std-ref">თავისუფალი RTOS მშობლიური API</span></a>: ESP-IDF თავისუფალი RTOS მშობლიური API .</li>
<li><a class="reference internal" href="thread-local-storage.html#pthread-api"><span class="std std-ref">Pthread API</span></a>: ESP-IDF ის pthread API .</li>
<li><a class="reference internal" href="thread-local-storage.html#c11-std"><span class="std std-ref">C11 სტანდარტი</span></a>C11 სტანდარტი შემოიტანს სპეციალურ საკვანძო სიტყვას ცვლადების ძაფის ლოკალურად გამოცხადებისთვის.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="freertos-native-api">
<span id="freertos-native"></span><h2>თავისუფალი RTOS მშობლიური API<a class="headerlink" href="thread-local-storage.html#freertos-native-api" title="Permalink to this headline">¶</a></h2>
<p>ESP-IDF Free RTOS უზრუნველყოფს შემდეგ API ს ძაფების ლოკალური ცვლადების სამართავად:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="../api-reference/system/freertos.html#_CPPv433vTaskSetThreadLocalStoragePointer12TaskHandle_t10BaseType_tPv" title="vTaskSetThreadLocalStoragePointer"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">vTaskSetThreadLocalStoragePointer()</span></code></a></li>
<li><a class="reference internal" href="../api-reference/system/freertos.html#_CPPv434pvTaskGetThreadLocalStoragePointer12TaskHandle_t10BaseType_t" title="pvTaskGetThreadLocalStoragePointer"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">pvTaskGetThreadLocalStoragePointer()</span></code></a></li>
<li><a class="reference internal" href="../api-reference/system/freertos.html#_CPPv447vTaskSetThreadLocalStoragePointerAndDelCallback12TaskHandle_t10BaseType_tPv27TlsDeleteCallbackFunction_t" title="vTaskSetThreadLocalStoragePointerAndDelCallback"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">vTaskSetThreadLocalStoragePointerAndDelCallback()</span></code></a></li>
</ul>
</div></blockquote>
<p>ამ შემთხვევაში, გამოყოფილი ცვლადების მაქსიმალური რაოდენობა შეზღუდულია
<code class="docutils literal notranslate"><span class="pre">configNUM_THREAD_LOCAL_STORAGE_POINTERS</span></code> მაკრო. ცვლადები ინახება დავალების მართვის ბლოკში (TCB) და მათზე წვდომა ხდება მათი ინდექსის საშუალებით. გაითვალისწინეთ, რომ ინდექსი 0 დაცულია ESP-IDF შიდა გამოყენებისთვის. ამ API გამოყენებით მომხმარებელს შეუძლია გამოყოს ნებისმიერი ზომის ძაფების ლოკალური ცვლადები და მიანიჭოს ისინი ნებისმიერი რაოდენობის დავალებებს. სხვადასხვა დავალებას შეიძლება ჰქონდეს TLS ცვლადების სხვადასხვა ნაკრები. თუ ცვლადის ზომა 4 ბაიტზე მეტია, მაშინ მომხმარებელი პასუხისმგებელია მისთვის მეხსიერების გამოყოფაზე/განთავისუფლებაზე. ცვლადის განთავისუფლება იწყება Free RTOS მიერ, როდესაც დავალება წაიშლება, მაგრამ მომხმარებელმა უნდა უზრუნველყოს ფუნქცია (უკუკავშირი) სათანადო გასუფთავების მიზნით.</p>
</div>
<div class="section" id="pthread-api">
<span id="id1"></span><h2>Pthread API<a class="headerlink" href="thread-local-storage.html#pthread-api" title="Permalink to this headline">¶</a></h2>
<p>ESP-IDF უზრუნველყოფს შემდეგ pthread API thtread ლოკალური ცვლადების სამართავად:</p>
<blockquote>
<div><ul class="simple">
<li><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">pthread_key_create()</span></code></li>
<li><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">pthread_key_delete()</span></code></li>
<li><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">pthread_getspecific()</span></code></li>
<li><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">pthread_setspecific()</span></code></li>
</ul>
</div></blockquote>
<p>ამ API აქვს ზემოთ მოცემულის ყველა უპირატესობა, მაგრამ გამორიცხავს მის ზოგიერთ შეზღუდვას. ცვლადების რაოდენობა შემოიფარგლება მხოლოდ გროვაზე არსებული მეხსიერების ზომით. დინამიური ბუნების გამო, ეს API წარმოშობს დამატებით დატვირთვას წარმადობაზე მშობლიურ ტერმინთან შედარებით.</p>
</div>
<div class="section" id="c11-standard">
<span id="c11-std"></span><h2>C11 სტანდარტი<a class="headerlink" href="thread-local-storage.html#c11-standard" title="Permalink to this headline">¶</a></h2>
<p>ESP-IDF თავისუფალი RTOS მხარს უჭერს ძაფების ლოკალურ ცვლადებს C11 სტანდარტის შესაბამისად (ისინი, რომლებიც მითითებულია <code class="docutils literal notranslate"><span class="pre">__thread</span></code> საკვანძო სიტყვა). ამ GCC ფუნქციის შესახებ დეტალებისთვის იხილეთ <a class="reference external" href="https://gcc.gnu.org/onlinedocs/gcc-5.5.0/gcc/Thread-Local.html#Thread-Local">https://gcc.gnu.org/onlinedocs/gcc-5.5.0/gcc/Thread-Local.html#Thread-Local</a>ამ ტიპის ცვლადებისთვის საცავი გამოყოფილია დავალების დასტაზე. გაითვალისწინეთ, რომ პროგრამაში ყველა ასეთი ცვლადისთვის ადგილი გამოიყოფა სისტემაში ყველა დავალების დასტაზე, მაშინაც კი, თუ ეს დავალება საერთოდ არ იყენებს ასეთ ცვლადებს. მაგალითად, ESP-IDF სისტემის დავალებები (მაგალითად <code class="docutils literal notranslate"><span class="pre">ipc</span></code>, <code class="docutils literal notranslate"><span class="pre">timer</span></code> დავალებებს და ა.შ.) ასევე ექნება გამოყოფილი დამატებითი დასტის სივრცე. ამიტომ, ეს ფუნქცია სიფრთხილით უნდა იქნას გამოყენებული. არსებობს კომპრომისი: C11 ძაფიანი ლოკალური ცვლადები საკმაოდ მოსახერხებელია პროგრამირებაში გამოსაყენებლად და მათზე წვდომა შესაძლებელია მხოლოდ რამდენიმე Xtensa ინსტრუქციის გამოყენებით, მაგრამ ეს უპირატესობა სისტემაში ყველა დავალებისთვის დამატებითი დასტის გამოყენების ღირებულებასთან ერთად მოდის. ცვლადების განაწილების სტატიკური ბუნების გამო, სისტემაში ყველა დავალებას აქვს C11 ძაფიანი ლოკალური ცვლადების ერთნაირი ნაკრები.</p>
</div>
</div>
</div>
</div>
<footer>
<div aria-label="footer navigation" class="rst-footer-buttons" role="navigation">
<a accesskey="n" class="btn btn-neutral float-right" href="tools/index.html" rel="next" title="Tools">შემდეგი <span class="fa fa-arrow-circle-right"></span></a>
<a accesskey="p" class="btn btn-neutral float-left" href="../security/secure-boot.html" rel="prev" title="Secure Boot"><span class="fa fa-arrow-circle-left"></span> წინა</a>
</div>
<hr/>
<div role="contentinfo">
<p>
        © საავტორო უფლება 2016 - 2019, Espressif Systems (შანხაი) კომპანია, შპს
      
        <span class="commit">
          რევიზია <code>f9108063</code>.
        </span>
</p>
</div>
  Built with <a href="http://sphinx-doc.org/">სფინქსი</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">თემა</a> provided by <a href="https://readthedocs.org">წაიკითხეთ დოკუმენტები</a>. 

</footer>
</div>
</div>
</section>
</div>
<script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
</body>
</html>